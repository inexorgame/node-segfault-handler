language: cpp
os: linux
dist: trusty
sudo: required
services:
  - docker

notifications:
  email:
    on_success: never
    on_failure: change

git:
  depth: 5

jobs:
  include:
    - env: docker_tag="ubuntu-xenial-node-js-8"
    - env: docker_tag="ubuntu-xenial-node-js-6"

before_install:
  - sudo docker pull inexorgame/ci-docker':'${docker_tag} ;

script:
  # FIXME: when running Linux next time fix the file rights directly and commit, at least that should be somehow possible, see core repo...
  - sudo chmod +x ./tool/travis.sh
  - sudo docker run -v $(pwd)':'/segfault --net=host -it inexorgame/ci-docker':'${docker_tag} /segfault/tool/travis.sh;

deploy:
  provider: bintray
  file: "travis/travis.json"
  user: "inexorbot"
  key:
    - secure: ${BINTRAY_KEY}
  on:
    all_branches: true
